## 事件循环原理

### 进程
程序的运行需要自己的专属内存空间，这块专属内存空间可以理解为进程

### 线程
运行代码的称之为线程，一个进程至少有一个线程，进程开启后会自动创建一个线程，该线程称之为主线程
如果程序需要同时执行多块代码，主线程会启动更多的线程来执行代码，所以一个进程中可以包含多个线程

### 浏览器是一个多进程多线程的应用程序
浏览器进程：主要负责界面显示、用户交互、子进程管理等
网络进程：负责加载网络资源。网络进程内部会启动多个线程来处理不同的网络任务
渲染进程：渲染进程启动后，会开启渲染主线程，主线程负责执行html、css、js代码
等等
默认情况下。浏览器会为每一个标签开启一个新的渲染进程，保证不同的标签页之间不相互影响

### 事件循环发生在渲染主线程中
--------渲染主线程
--------消息队列
--------其他线程

1. 最开始的时候，渲染主线程会进入一个无限循环状态
2. 每一次循环会检查消息队列中是否有任务存在。如果有，就取出第一个任务放到主线程执行，执行完一个后进入下一次循环。如果没有，则进入休眠状态
3. 其他所有线程可以随时向消息队列添加任务。新任务会加到消息队列的末尾。添加新任务时，如果主线程是休眠状态，则会将其唤醒继续循环拿取任务
这整个过程被称之为事件循环

但是事件循环会包含很多细节，比如代码执行的过程中遇到一些无法立即执行的任务
计时器（settimeout、setinterval）-----计时线程
网络通讯（ajax、axios、fetch等）  -----
用户操作（监听事件）              ------

问题：如何理解 js 的异步？
js 是一门单线程语言，这是因为它运行在浏览器的渲染主线程中，而渲染主线程只有一个
渲染主线程承担很多工作，包含渲染页面、执行js都在这里完成
如果使用同步的方式则可能导致渲染主线程阻塞，从而导致消息队列中的任务无法得到执行
这样子会导致页面卡死现象
所以浏览器采用异步的方式来避免，具体的做法是当某些任务发生时，比如计算器、网络通讯、事件监听，主线程将任务交给其他线程去处理
自身立即结束任务的执行，转而执行后续代码，当其他线程完成时，将事先传递的回调函数包装成任务，加入到消息队列的末尾排队，等待主线程调度执行
在这种异步模式下，浏览器永不阻塞，从而最大限度的保证了单线程的流畅运行

问题：任务有优先级吗？
任务是没有优先级的，但是消息队列是有优先级的
每一个任务都有一个任务类型，同一个类型的任务必须在同一个任务队列中，不同类型的任务属于不同的队列
浏览器必须准备好一个微任务队列，微任务队列的任务优先级最高
常见的任务队列有哪些？
延时队列：存放计时器
交互队列：存放事件处理任务
微队列：promise、MutationObserver
